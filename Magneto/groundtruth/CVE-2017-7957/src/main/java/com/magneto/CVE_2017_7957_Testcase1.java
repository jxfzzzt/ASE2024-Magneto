package com.magneto;

import com.thoughtworks.xstream.XStream;
import com.thoughtworks.xstream.XStreamException;
import org.junit.Test;
import static org.junit.Assert.*;

public class CVE_2017_7957_Testcase1 {

    @Test(timeout = 60000)
    public void testDeniedInstanceOfVoid() {
        try {
            XStream xstream = new XStream();
            xstream.fromXML("<void/>");
            fail("the test fail");
        } catch (XStreamException e) {
            validateThrow(e);
        }
    }

    public void validateThrow(Throwable e) {
        assertTrue(e.getMessage().startsWith("Security alert") || "com.thoughtworks.xstream.security.ForbiddenClassException".equals(e.getClass().getName()));
    }
}
