package com.magneto;

import org.apache.commons.beanutils.PropertyUtils;
import org.junit.Test;
import static org.junit.Assert.*;

public class CVE_2019_10086_Testcase1 {

    @Test(timeout = 60000)
    public void testSuppressClassPropertyByDefault() throws Exception {
        Object bean = new Object();
        try {
            Object clazz = PropertyUtils.getProperty(bean, "class");
            validateReturnValue(clazz);
            fail("fail the test");
        } catch (final NoSuchMethodException ex) {
            validateThrow(ex);
        }
    }

    public void validateThrow(Throwable e) {
        assertTrue(e instanceof NoSuchMethodException);
    }

    public void validateReturnValue(Object object) {
        assertNull(object);
    }
}
