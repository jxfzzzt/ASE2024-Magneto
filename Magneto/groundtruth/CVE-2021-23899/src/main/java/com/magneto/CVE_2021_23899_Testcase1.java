package com.magneto;

import com.google.json.JsonSanitizer;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class CVE_2021_23899_Testcase1 {

    @Test(timeout = 60000)
    public void testXssPayload() {
        String input = "x</\\script>u\\u\\uu\ufffd\ufffd\\u7u\\u\\u\\u\ufffdu<\\script>5+alert(1)//";
        String sanitize = JsonSanitizer.sanitize(input);
        validateReturnValue(sanitize);
    }

    public void validateReturnValue(String sanitize) {
        assertEquals("\"x\\u003c/script>uuuu\uFFFD\uFFFDu7uuuu\uFFFDu\\u003cscript>5+alert(1)//\"", sanitize);
    }
}
