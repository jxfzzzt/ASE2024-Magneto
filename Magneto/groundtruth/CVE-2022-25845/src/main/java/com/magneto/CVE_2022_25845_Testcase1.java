package com.magneto;

import com.alibaba.fastjson.JSON;
import org.junit.Test;

import java.util.Map;

import static org.junit.Assert.assertNull;
import static org.junit.Assert.assertTrue;

public class CVE_2022_25845_Testcase1 {

    @Test(timeout = 60000)
    public void testForException() {
        String text = "{\"@type\":\"java.lang.RuntimeException\",\"localizedMessage\":\"e1\",\"message\":\"e1\",\"stackTrace\":[{\"className\":\"com.magneto.CVE_2022_25845_Testcase1\",\"fileName\":\"CVE_2022_25845_Testcase1.java\",\"lineNumber\":12,\"methodName\":\"testForException\",\"nativeMethod\":false},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2,\"methodName\":\"invoke0\",\"nativeMethod\":true},{\"className\":\"sun.reflect.NativeMethodAccessorImpl\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"java.lang.reflect.Method\",\"fileName\":\"Method.java\",\"lineNumber\":498,\"methodName\":\"invoke\",\"nativeMethod\":false},{\"className\":\"org.junit.runners.model.FrameworkMethod$1\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":59,\"methodName\":\"runReflectiveCall\",\"nativeMethod\":false},{\"className\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"org.junit.runners.model.FrameworkMethod\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":56,\"methodName\":\"invokeExplosively\",\"nativeMethod\":false},{\"className\":\"org.junit.internal.runners.statements.InvokeMethod\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17,\"methodName\":\"evaluate\",\"nativeMethod\":false},{\"className\":\"org.junit.internal.runners.statements.FailOnTimeout$CallableStatement\",\"fileName\":\"FailOnTimeout.java\",\"lineNumber\":299,\"methodName\":\"call\",\"nativeMethod\":false},{\"className\":\"org.junit.internal.runners.statements.FailOnTimeout$CallableStatement\",\"fileName\":\"FailOnTimeout.java\",\"lineNumber\":293,\"methodName\":\"call\",\"nativeMethod\":false},{\"className\":\"java.util.concurrent.FutureTask\",\"fileName\":\"FutureTask.java\",\"lineNumber\":266,\"methodName\":\"run\",\"nativeMethod\":false},{\"className\":\"java.lang.Thread\",\"fileName\":\"Thread.java\",\"lineNumber\":750,\"methodName\":\"run\",\"nativeMethod\":false}]}\n";

        Object obj = JSON.parse(text);
        validateReturnValue(obj);
    }

    public void validateReturnValue(Object obj) {
        assertTrue(obj instanceof Map);
    }
}
