package com.magneto;

import org.json.JSONException;
import org.json.JSONObject;
import org.json.XML;
import org.junit.Test;
import static org.junit.Assert.assertTrue;

public class CVE_2022_45688_Testcase1 {

    public String getLongString() {
        String s = "";
        for (int i = 0; i < 6000; i++) s += "<a>";
        for (int i = 0; i < 6000; i++) s += "</a>";
        return s;
    }

    @Test(timeout = 60000)
    public void testStackOverflow() {
        try {
            String longString = getLongString();
            JSONObject jsonObject = XML.toJSONObject(longString);
            jsonObject.toString();
        } catch (JSONException e) {
            validateThrow(e);
        }
    }

    public void validateThrow(Throwable e) {
        assertTrue(e instanceof JSONException);
    }
}
