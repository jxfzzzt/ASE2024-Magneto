package com.magneto;

import net.minidev.json.JSONValue;
import net.minidev.json.parser.ParseException;
import org.junit.Test;
import static org.junit.Assert.assertTrue;

public class CVE_2023_1370_Testcase1 {

    @Test
    public void stressTest() {
        int size = 10000;
        StringBuilder sb = new StringBuilder(10 + size * 4);
        for (int i = 0; i < size; i++) {
            sb.append("{a:");
        }
        sb.append("true");
        for (int i = 0; i < size; i++) {
            sb.append("}");
        }
        String s = sb.toString();
        try {
            JSONValue.parseWithException(s);
        } catch (ParseException e) {
            validateThrow(e);
        }
    }

    public void validateThrow(Throwable e) {
        assertTrue(e instanceof ParseException);
    }
}
